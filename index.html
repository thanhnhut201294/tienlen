<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Ghi ƒëi·ªÉm Ti·∫øn L√™n</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      margin: 0;
      padding: 1rem;
      background: #f2f2f2;
      color: #333;
    }
    h1 {
      text-align: center;
      margin-bottom: 1rem;
    }
    .player-setup, .score-input, .history {
      background: #fff;
      border-radius: 10px;
      padding: 1rem;
      margin-bottom: 1.5rem;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    label {
      display: block;
      margin: 0.5rem 0 0.25rem;
    }
    input[type="text"], input[type="number"] {
      width: 100%;
      padding: 0.5rem;
      border-radius: 8px;
      border: 1px solid #ccc;
      font-size: 1rem;
    }
    .avatar-row {
      display: flex;
      justify-content: space-around;
      margin-top: 1rem;
    }
    .avatar {
      text-align: center;
    }
    .avatar img {
      border-radius: 50%;
      width: 64px;
      height: 64px;
      margin-bottom: 0.25rem;
    }
    .score-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 1rem;
    }
    button {
      background: #00b894;
      color: #fff;
      border: none;
      padding: 0.75rem;
      width: 100%;
      font-size: 1rem;
      border-radius: 8px;
      margin-top: 1rem;
    }
    button:hover {
      background: #019875;
    }
    .error {
      color: red;
      margin-top: 0.5rem;
      font-size: 0.9rem;
    }
    .history-item {
      border-top: 1px solid #ccc;
      padding-top: 0.5rem;
      margin-top: 0.5rem;
      font-size: 0.95rem;
    }
    @media (min-width: 768px) {
      .score-grid {
        grid-template-columns: repeat(4, 1fr);
      }
    }
  </style>
</head>
<body>

<h1>üÉè Ghi ƒëi·ªÉm Ti·∫øn L√™n</h1>

<div class="player-setup">
  <h2>1. Nh·∫≠p t√™n ng∆∞·ªùi ch∆°i</h2>
  <label>Ng∆∞·ªùi 1:</label>
  <input type="text" id="player1" />
  <label>Ng∆∞·ªùi 2:</label>
  <input type="text" id="player2" />
  <label>Ng∆∞·ªùi 3:</label>
  <input type="text" id="player3" />
  <label>Ng∆∞·ªùi 4:</label>
  <input type="text" id="player4" />
  <button onclick="startGame()">B·∫Øt ƒë·∫ßu</button>
  <div class="error" id="nameError"></div>
</div>

<div class="score-input" style="display:none;">
  <h2>2. Nh·∫≠p ƒëi·ªÉm t·ª´ng v√°n</h2>
  <div class="avatar-row" id="avatarRow"></div>
  <div class="score-grid" id="scoreInputs"></div>
  <button onclick="submitScores()">L∆∞u ƒëi·ªÉm</button>
  <div class="error" id="scoreError"></div>
</div>

<div class="history" style="display:none;">
  <h2>L·ªãch s·ª≠ v√°n ch∆°i</h2>
  <div id="historyLog"></div>
</div>

<audio id="successSound" src="https://www.soundjay.com/buttons/sounds/button-09.mp3"></audio>

<script>
  let players = [];
  let totalScores = [0,0,0,0];
  const avatars = [];

  function startGame() {
    const names = [
      document.getElementById("player1").value.trim(),
      document.getElementById("player2").value.trim(),
      document.getElementById("player3").value.trim(),
      document.getElementById("player4").value.trim()
    ];

    const nameSet = new Set(names);
    if (names.includes("") || nameSet.size < 4) {
      document.getElementById("nameError").innerText = "T√™n kh√¥ng ƒë∆∞·ª£c ƒë·ªÉ tr·ªëng ho·∫∑c tr√πng nhau!";
      return;
    }

    players = names;
    document.querySelector(".player-setup").style.display = "none";
    document.querySelector(".score-input").style.display = "block";
    document.querySelector(".history").style.display = "block";

    const avatarRow = document.getElementById("avatarRow");
    const scoreInputs = document.getElementById("scoreInputs");
    avatarRow.innerHTML = "";
    scoreInputs.innerHTML = "";

    players.forEach((name, idx) => {
      const seed = encodeURIComponent(name);
      avatars[idx] = `https://api.dicebear.com/7.x/thumbs/svg?seed=${seed}`;
      avatarRow.innerHTML += `
        <div class="avatar">
          <img src="${avatars[idx]}" alt="${name}">
          <div>${name}</div>
        </div>
      `;
      scoreInputs.innerHTML += `
        <div>
          <label>${name}</label>
          <input type="number" id="score${idx}" value="0" />
        </div>
      `;
    });
  }

  function submitScores() {
    const roundScores = [];
    let sum = 0;
    for (let i = 0; i < 4; i++) {
      const val = parseInt(document.getElementById("score"+i).value);
      if (isNaN(val)) {
        document.getElementById("scoreError").innerText = "Vui l√≤ng nh·∫≠p ƒëi·ªÉm h·ª£p l·ªá cho t·∫•t c·∫£ ng∆∞·ªùi ch∆°i.";
        return;
      }
      roundScores.push(val);
      sum += val;
    }

    if (sum !== 0) {
      document.getElementById("scoreError").innerText = "T·ªïng ƒëi·ªÉm 4 ng∆∞·ªùi ph·∫£i b·∫±ng 0!";
      return;
    }

    // update t·ªïng ƒëi·ªÉm
    for (let i = 0; i < 4; i++) {
      totalScores[i] += roundScores[i];
    }

    // hi·ªÉn th·ªã l·ªãch s·ª≠
    const log = document.getElementById("historyLog");
    let html = "<div class='history-item'>";
    for (let i = 0; i < 4; i++) {
      html += `<strong>${players[i]}</strong>: ${roundScores[i]} | T·ªïng: ${totalScores[i]}<br/>`;
    }
    html += "</div>";
    log.innerHTML = html + log.innerHTML;

    // reset input
    for (let i = 0; i < 4; i++) {
      document.getElementById("score"+i).value = 0;
    }
    document.getElementById("scoreError").innerText = "";

    document.getElementById("successSound").play();
  }
</script>

</body>
</html>
